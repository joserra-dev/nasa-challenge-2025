<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Costal Savior - NASA Space Apps</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="game-container">
        <header>
            <h1>ğŸŒŠ Costal Savior</h1>
            <div id="resources">
                <span>ğŸ’° Presupuesto: <span id="money" class="resource-value">100</span></span>
                <span>ğŸ˜Š Bienestar: <span id="wellbeing" class="resource-value">50</span></span>
                <span>ğŸŒ¿ Ambiente: <span id="environment" class="resource-value">50</span></span>
                <span>ğŸ›¡ï¸ Resiliencia: <span id="resilience" class="resource-value">20</span></span>
                <span>ğŸ“… AÃ±o: <span id="year" class="resource-value">2025</span></span>
            </div>
        </header>

        <main>
            <div id="game-board">
                <!-- Tablero generado dinÃ¡micamente -->
            </div>

            <div id="control-panel">
                <h3>Acciones</h3>
                <div class="action-buttons">
                    <button onclick="buildStructure('residential')">ğŸ  Zona Residencial (+Bienestar, -Ambiente)</button>
                    <button onclick="buildStructure('industrial')">ğŸ­ Zona Industrial (+Dinero, -Ambiente)</button>
                    <button onclick="buildStructure('mangrove')">ğŸŸ¢ Restaurar Manglar (+Ambiente, +Resiliencia)</button>
                    <button onclick="buildStructure('seawall')">ğŸ›¡ï¸ Construir Dique (+Resiliencia, -Dinero)</button>
                    <button id="consult-ai-btn">ğŸ“¡ Consultar IA</button>

                </div>
                
                <div class="save-controls">
                    <button onclick="manualSave()">ğŸ’¾ Guardar</button>
                    <button onclick="manualLoad()">ğŸ“‚ Cargar</button>
                    <button onclick="newGame()">ğŸ”„ Nuevo Juego</button>
                    <button onclick="viewStats()">ğŸ“Š EstadÃ­sticas</button>
                </div>

                <button id="next-turn-btn" onclick="nextTurn()">Siguiente Turno (5 aÃ±os)</button>

                <!-- Panel NASA -->
                <div id="nasa-data-panel" class="nasa-data-update">
                    <!-- Se llenarÃ¡ dinÃ¡micamente desde JS -->
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de eventos -->
    <div id="event-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="event-title">Evento ClimÃ¡tico</h2>
            <p id="event-description"></p>
            <button onclick="closeEventModal()">Continuar</button>
        </div>
    </div>

    <!-- Modal de estadÃ­sticas -->
    <div id="stats-modal" class="modal hidden">
        <div class="modal-content">
            <h2>ğŸ“Š EstadÃ­sticas de Partidas</h2>
            <div id="stats-content">
                <!-- Contenido dinÃ¡mico -->
            </div>
            <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                <button onclick="closeStatsModal()">Cerrar</button>
                <button onclick="exportSave()">ğŸ“¤ Exportar Partida</button>
                
                <input type="file" id="import-file" accept=".json" style="display: none;">
                <button onclick="document.getElementById('import-file').click()">ğŸ“¥ Importar Partida</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="data.js"></script>
    <script src="nasa-api.js"></script>
    <script src="save-manager.js"></script>
    <script src="game.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Importar partidas
            const importFile = document.getElementById('import-file');
            if (importFile) {
                importFile.addEventListener('change', function(e) {
                    if (e.target.files[0]) {
                        importSave(e.target.files[0]);
                    }
                });
            }

            // AnimaciÃ³n inicial de NASA
            const nasaPanel = document.getElementById('nasa-data-panel');
            if (nasaPanel) {
                nasaPanel.classList.add('nasa-data-update');
            }
        });
    </script>
    <script>
        // const OPENAI_API_KEY = "tu_api_key_aqui"; // âš ï¸ solo para pruebas locales
		// const GEMINI_API_KEY = "AIzaSyCy62WY0Far__223dj5AlPQagGTMihFoYQ"; // âš ï¸ solo para pruebas locales

    </script>


    Modal para IA
    <div id="ai-modal" class="modal hidden">
    <div class="modal-content ai-modal">
        <h2>Asesor de IA ClimÃ¡tica</h2>
        <div id="ai-response">
        <p>La IA analizarÃ¡ tu estado actual del juego y los datos de NASA para recomendarte la mejor estrategia.</p>
        </div>
        <button onclick="closeAIModal()">Cerrar</button>
    </div>
</div>
<!-- API Config Modal -->
<div id="api-config-modal" class="modal hidden" style="z-index:9999;">
  <div class="modal-content" style="max-width:520px;padding:16px;background:white;border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,.2);margin:6% auto;">
    <h3>Configurar Servicio de IA</h3>
    <p>Elige el proveedor y pega tu API Key. <strong>No compartas tu clave pÃºblicamente.</strong></p>

    <label for="api-provider">Proveedor</label>
    <select id="api-provider" style="width:100%;margin-bottom:8px;padding:8px;">
      <option value="gemini">Gemini (Google)</option>
      <option value="openai">OpenAI</option>
      <option value="other">Otro</option>
    </select>

    <label for="api-key">API Key</label>
    <input id="api-key" type="text" placeholder="sk-..." style="width:100%;padding:8px;margin-bottom:8px;" />

    <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
      <input id="api-remember" type="checkbox" />
      <label for="api-remember">Recordarme en este dispositivo (persistente)</label>
    </div>

    <div style="display:flex;gap:8px;justify-content:flex-end;">
      <button id="api-cancel-btn" class="btn">Cancelar</button>
      <button id="api-save-btn" class="btn primary">Guardar y Consultar</button>
    </div>

    <small style="display:block;margin-top:8px;color:#666;">
      Nota: Guardar la clave en el navegador implica riesgos. Para producciÃ³n, gestiona las claves en un backend seguro.
    </small>
  </div>
</div>


</body>
</html>
